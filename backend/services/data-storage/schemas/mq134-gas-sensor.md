# MQ134 Gas Sensor Schema

## Description
Schema for MQ134 gas sensor data. This sensor detects various gases including ammonia (NH3), sulfur compounds, benzene series, and smoke.

## InfluxDB Measurement
**Measurement Name:** `mq134_gas`

## Tags (Indexed)
Tags are indexed and used for filtering queries.

| Tag Name      | Type   | Description                                      | Example              |
|---------------|--------|--------------------------------------------------|----------------------|
| device_id     | string | Unique identifier for the device                 | "mq134-001"          |
| location      | string | Physical location of the sensor                  | "kitchen"            |
| zone          | string | Zone or area within location                     | "cooking-area"       |
| calibration   | string | Calibration status                               | "calibrated"         |
| firmware_ver  | string | Firmware version of the device                   | "v1.0.5"             |

## Fields (Not Indexed)
Fields contain the actual measurement data.

| Field Name            | Type    | Unit        | Description                                    |
|-----------------------|---------|-------------|------------------------------------------------|
| concentration_ppm     | float   | ppm         | Gas concentration in parts per million         |
| raw_value             | integer | -           | Raw ADC reading from sensor                    |
| voltage               | float   | volts       | Sensor output voltage                          |
| resistance_kohm       | float   | kΩ          | Sensor resistance                              |
| gas_type              | string  | -           | Detected gas type (if identifiable)            |
| alarm_triggered       | boolean | -           | Whether alarm threshold is exceeded            |
| alarm_level           | string  | -           | Alarm severity: "normal", "warning", "danger"  |
| threshold_ppm         | float   | ppm         | Configured alarm threshold                     |
| temperature_c         | float   | celsius     | Operating temperature                          |
| humidity_percent      | float   | percentage  | Relative humidity (affects readings)           |
| rssi                  | float   | dBm         | Signal strength indicator                      |
| battery_level         | float   | percentage  | Battery level if device is battery-powered     |

## Timestamp
- **Field:** Automatically generated by InfluxDB on data ingestion
- **Precision:** Nanoseconds
- **Timezone:** UTC

## Example Data Point (Line Protocol)
```
mq134_gas,device_id=mq134-001,location=kitchen,zone=cooking-area,calibration=calibrated,firmware_ver=v1.0.5 concentration_ppm=12.5,raw_value=512,voltage=2.45,resistance_kohm=22.3,gas_type="NH3",alarm_triggered=false,alarm_level="normal",threshold_ppm=50.0,temperature_c=23.2,humidity_percent=55.0,rssi=-48.5,battery_level=88.0 1697472000000000000
```

## Example Data Point (JSON)
```json
{
  "measurement": "mq134_gas",
  "tags": {
    "device_id": "mq134-001",
    "location": "kitchen",
    "zone": "cooking-area",
    "calibration": "calibrated",
    "firmware_ver": "v1.0.5"
  },
  "fields": {
    "concentration_ppm": 12.5,
    "raw_value": 512,
    "voltage": 2.45,
    "resistance_kohm": 22.3,
    "gas_type": "NH3",
    "alarm_triggered": false,
    "alarm_level": "normal",
    "threshold_ppm": 50.0,
    "temperature_c": 23.2,
    "humidity_percent": 55.0,
    "rssi": -48.5,
    "battery_level": 88.0
  },
  "timestamp": 1697472000000000000
}
```

## Indexing Strategy
- **Tags are automatically indexed** in InfluxDB for fast filtering
- **Device_id** is the primary filter for device-specific queries
- **Location and zone** enable spatial filtering
- **Calibration** allows filtering by calibration status
- **Firmware_ver** allows version-specific analysis

## Data Retention
- **Raw Data:** 30 days (configurable)
- **1-minute aggregates:** 90 days
- **1-hour aggregates:** 365 days
- **Daily aggregates:** 5 years

## Alarm Levels
- **normal:** concentration_ppm < threshold_ppm
- **warning:** threshold_ppm ≤ concentration_ppm < (threshold_ppm * 1.5)
- **danger:** concentration_ppm ≥ (threshold_ppm * 1.5)

## Common Detectable Gases
- Ammonia (NH3)
- Hydrogen Sulfide (H2S)
- Benzene (C6H6)
- Smoke and combustible gases
- Alcohol vapors

## Common Queries
See `queries/mq134-gas-examples.flux` for example queries.
